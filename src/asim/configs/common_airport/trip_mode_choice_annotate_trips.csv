Description,Target,Expression
,_origin_local_dist,"reindex(land_use.walk_dist_local_bus, df.origin)"
,_origin_prm_dist,"reindex(land_use.walk_dist_premium_transit, df.origin)"
,_origin_mix_dist,"np.minimum(_origin_local_dist, _origin_prm_dist)"
,_dest_local_dist,"reindex(land_use.walk_dist_local_bus, df.destination)"
,_dest_prm_dist,"reindex(land_use.walk_dist_premium_transit, df.destination)"
,_dest_mix_dist,"np.minimum(_dest_local_dist, _dest_prm_dist)"
,_party,df.tour_id.map(tours.number_of_participants)
,_tour_participants,"np.where(df.trip_num ==2, 1, _party)"
# resetting trip origin and destination based on mode,,
# this is done after the above caluclations so walk dist is the value used in utility calcs,,
,_destination,df.destination
,_destination,"np.where((df.trip_mode == 'PARK_LOC1') & (df.outbound == False), parkLocation1Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'PARK_LOC2') & (df.outbound == False), parkLocation2Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'PARK_LOC3') & (df.outbound == False), parkLocation3Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'PARK_LOC4') & (df.outbound == False), parkLocation4Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'PARK_LOC5') & (df.outbound == False), parkLocation5Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'PARK_ESCORT') & (df.outbound == False), parkEscortLocationMgra, _destination)"
,_destination,"np.where((df.trip_mode == 'RENTAL') & (df.outbound == False), rentalLocationMgra, _destination)"
,_destination,"np.where((df.trip_mode == 'SHUTTLEVAN') & (df.outbound == False), shuttleVanLocation, _destination)"
,_destination,"np.where((df.trip_mode == 'HOTEL_COURTESY') & (df.outbound == False), hotelCourtesyMgra, _destination)"
,_destination,"np.where((df.trip_mode == 'RIDEHAIL_LOC1') & (df.outbound == False), ridehailLocation1Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'RIDEHAIL_LOC2') & (df.outbound == False), ridehailLocation2Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'TAXI_LOC1') & (df.outbound == False), ridehailLocation1Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'TAXI_LOC2') & (df.outbound == False), ridehailLocation2Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'CURB_LOC1') & (df.outbound == False), curbLocation1Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'CURB_LOC2') & (df.outbound == False), curbLocation2Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'CURB_LOC3') & (df.outbound == False), curbLocation3Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'CURB_LOC4') & (df.outbound == False), curbLocation4Mgra, _destination)"
,_destination,"np.where((df.trip_mode == 'CURB_LOC5') & (df.outbound == False), curbLocation5Mgra, _destination)"
,_destination,"np.where(df.trip_mode.isin(['WALK_LOC', 'WALK_PRM', 'WALK_MIX', 'KNR_LOC', 'KNR_PRM', 'KNR_MIX', 'TNC_LOC', 'TNC_PRM', 'TNC_MIX']) & (df.outbound == False), transitMgra, _destination)"
,_destination,"np.where((df.trip_mode == 'WALK') & (df.outbound == False), terminalMgra, _destination)"
,destination,_destination
,_origin,df.origin
,_origin,"np.where((df.trip_mode == 'PARK_LOC1') & (df.outbound == True), parkLocation1Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'PARK_LOC2') & (df.outbound == True), parkLocation2Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'PARK_LOC3') & (df.outbound == True), parkLocation3Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'PARK_LOC4') & (df.outbound == True), parkLocation4Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'PARK_LOC5') & (df.outbound == True), parkLocation5Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'PARK_ESCORT') & (df.outbound == True), parkEscortLocationMgra, _origin)"
,_origin,"np.where((df.trip_mode == 'RENTAL') & (df.outbound == True), rentalLocationMgra, _origin)"
,_origin,"np.where((df.trip_mode == 'SHUTTLEVAN') & (df.outbound == True), shuttleVanLocation, _origin)"
,_origin,"np.where((df.trip_mode == 'HOTEL_COURTESY') & (df.outbound == True), hotelCourtesyMgra, _origin)"
,_origin,"np.where((df.trip_mode == 'RIDEHAIL_LOC1') & (df.outbound == True), ridehailLocation1Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'RIDEHAIL_LOC2') & (df.outbound == True), ridehailLocation2Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'TAXI_LOC1') & (df.outbound == True), ridehailLocation1Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'TAXI_LOC2') & (df.outbound == True), ridehailLocation2Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'CURB_LOC1') & (df.outbound == True), curbLocation1Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'CURB_LOC2') & (df.outbound == True), curbLocation2Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'CURB_LOC3') & (df.outbound == True), curbLocation3Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'CURB_LOC4') & (df.outbound == True), curbLocation4Mgra, _origin)"
,_origin,"np.where((df.trip_mode == 'CURB_LOC5') & (df.outbound == True), curbLocation5Mgra, _origin)"
,_origin,"np.where(df.trip_mode.isin(['WALK_LOC', 'WALK_PRM', 'WALK_MIX', 'KNR_LOC', 'KNR_PRM', 'KNR_MIX', 'TNC_LOC', 'TNC_PRM', 'TNC_MIX']) & (df.outbound == True), transitMgra, _origin)"
,_origin,"np.where((df.trip_mode == 'WALK') & (df.outbound == True), terminalMgra, _origin)"
,origin,_origin
#,,
,_is_drivealone," (df.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','RENTAL']) &  (_tour_participants ==1)) | (df.trip_mode.isin(['PARK_ESCORT','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & (df.trip_num == 2))"
,_is_shared2," (df.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','RENTAL']) & ( _tour_participants ==2)) | (df.trip_mode.isin(['RIDEHAIL_LOC1','RIDEHAIL_LOC2','TAXI_LOC1','TAXI_LOC2','PARK_ESCORT','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5'])  & ( _tour_participants == 1) & (df['trip_num'] ==1))"
,_is_shared3," (df.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','RENTAL', 'HOTEL_COURTESY', 'SHUTTLEVAN']) &  (_tour_participants >= 3)) | (df.trip_mode.isin(['RIDEHAIL_LOC1','RIDEHAIL_LOC2','TAXI_LOC1','TAXI_LOC2','PARK_ESCORT','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5', 'HOTEL_COURTESY', 'SHUTTLEVAN'])  & (_tour_participants >=2) & (df.trip_num == 1))"
,arrival_mode, df.trip_mode
,_trip_mode, df.trip_mode
,_trip_mode," np.where(_is_drivealone, 'DRIVEALONE', _trip_mode)"
,_trip_mode," np.where(_is_shared2, 'SHARED2',_trip_mode)"
,_trip_mode," np.where((_is_shared3) | (df.trip_mode.isin(['HOTEL_COURTESY', 'SHUTTLEVAN'])), 'SHARED3', _trip_mode)"
,trip_mode,_trip_mode
#,,
,_cost_parking,"(arrival_mode=='PARK_LOC1')*parkLocation1CostDay"
,_cost_parking,"_cost_parking+(arrival_mode=='PARK_LOC2')*parkLocation2CostDay"
,_cost_parking,"_cost_parking+(arrival_mode=='PARK_LOC3')*parkLocation3CostDay"
,_cost_parking,"_cost_parking+(arrival_mode=='PARK_LOC4')*parkLocation4CostDay"
,cost_parking,"_cost_parking+(arrival_mode=='PARK_LOC5')*parkLocation5CostDay"
#,,
,_cost_fare_drive,0
,_cost_fare_drive,"_cost_fare_drive + np.where(arrival_mode == 'RIDEHAIL_LOC1',1,0) * (df.partySizeRideHailLocation1AutoDist*ridehailCostPerMile)"
,cost_fare_drive,"_cost_fare_drive + np.where(arrival_mode == 'RIDEHAIL_LOC2',1,0) * (df.partySizeRideHailLocation2AutoDist*ridehailCostPerMile)"
#,,
#,_distance_walk,0
,_distance_walk,"(_origin_local_dist+_dest_local_dist) * np.where(trip_mode == 'WALK_LOC',1,0)"
,_distance_walk,"_distance_walk + (_origin_prm_dist+_dest_prm_dist) * np.where(trip_mode == 'WALK_PRM',1,0)"
,_distance_walk,"_distance_walk + (_origin_mix_dist+_dest_mix_dist) * np.where(trip_mode == 'WALK_MIX',1,0)"
,_distance_walk,"_distance_walk + _dest_local_dist * np.where(trip_mode == 'PNR_LOC',1,0) * np.where(df.outbound,1,0)"
,_distance_walk,"_distance_walk + _dest_prm_dist * np.where(trip_mode == 'PNR_PRM',1,0) * np.where(df.outbound,1,0)"
,_distance_walk,"_distance_walk + _dest_mix_dist * np.where(trip_mode == 'PNR_MIX',1,0) * np.where(df.outbound,1,0)"
,_distance_walk,"_distance_walk + _dest_local_dist * np.where(trip_mode == 'KNR_LOC',1,0) * np.where(df.outbound,1,0)"
,_distance_walk,"_distance_walk + _dest_prm_dist * np.where(trip_mode == 'KNR_PRM',1,0) * np.where(df.outbound,1,0)"
,_distance_walk,"_distance_walk + _dest_mix_dist * np.where(trip_mode == 'KNR_MIX',1,0) * np.where(df.outbound,1,0)"
,_distance_walk,"_distance_walk + _dest_local_dist * np.where(trip_mode == 'TNC_LOC',1,0) * np.where(df.outbound,1,0)"
,_distance_walk,"_distance_walk + _dest_prm_dist * np.where(trip_mode == 'TNC_PRM',1,0) * np.where(df.outbound,1,0)"
,_distance_walk,"_distance_walk + _dest_mix_dist * np.where(trip_mode == 'TNC_MIX',1,0) * np.where(df.outbound,1,0)"
,_distance_walk,"_distance_walk + _origin_local_dist * np.where(trip_mode == 'PNR_LOC',1,0) * np.where(~df.outbound,1,0)"
,_distance_walk,"_distance_walk + _origin_prm_dist * np.where(trip_mode == 'PNR_PRM',1,0) * np.where(~df.outbound,1,0)"
,_distance_walk,"_distance_walk + _origin_mix_dist * np.where(trip_mode == 'PNR_MIX',1,0) * np.where(~df.outbound,1,0)"
,_distance_walk,"_distance_walk + _dest_local_dist * np.where(trip_mode == 'KNR_LOC',1,0) * np.where(~df.outbound,1,0)"
,_distance_walk,"_distance_walk + _origin_prm_dist * np.where(trip_mode == 'KNR_PRM',1,0) * np.where(~df.outbound,1,0)"
,_distance_walk,"_distance_walk + _origin_mix_dist * np.where(trip_mode == 'KNR_MIX',1,0) * np.where(~df.outbound,1,0)"
,_distance_walk,"_distance_walk + _origin_local_dist * np.where(trip_mode == 'TNC_LOC',1,0) * np.where(~df.outbound,1,0)"
,_distance_walk,"_distance_walk + _origin_prm_dist * np.where(trip_mode == 'TNC_PRM',1,0) * np.where(~df.outbound,1,0)"
,distance_walk,"_distance_walk + _origin_mix_dist * np.where(trip_mode == 'TNC_MIX',1,0) * np.where(~df.outbound,1,0)"
#,,
,time_mm,0
,distance_mm,0
,cost_fare_mm,0
,distance_bike,0
#,,
,time_wait_drive,0
