Description,Target,Expression
# add additional fields,,
,tour_participants,trips.tour_id.map(tours.number_of_participants)
#,distance,odt_skims['SOV_NT_M_DIST']
# code time periods,,
,is_ea,trips.trip_period == 'EA'
,is_am,trips.trip_period == 'AM'
,is_md,trips.trip_period == 'MD'
,is_pm,trips.trip_period == 'PM'
,is_ev,trips.trip_period == 'EV'
,is_walk_LOC_transit,trips.trip_mode == 'WALK_LOC'
,is_walk_PRM_transit,trips.trip_mode.isin == 'WALK_PRM'
,is_walk_MIX_transit,trips.trip_mode.isin == 'WALK_MIX'
,is_knr_loc,"trips.trip_mode.isin(['KNR_LOC'])"
,is_knr_prm,"trips.trip_mode.isin(['KNR_PRM'])"
,is_knr_mix,"trips.trip_mode.isin(['KNR_MIX'])"
,is_tnc_loc,"trips.trip_mode.isin(['TNC_LOC'])"
,is_tnc_prm,"trips.trip_mode.isin(['TNC_PRM'])"
,is_tnc_mix,"trips.trip_mode.isin(['TNC_MIX'])"
,is_pnr_loc,"trips.trip_mode.isin(['PNR_LOC'])"
,is_pnr_prm,"trips.trip_mode.isin(['PNR_PRM'])"
,is_pnr_mix,"trips.trip_mode.isin(['PNR_MIX'])"
,outbound,trips.outbound
,inbound,~trips.outbound
# code vot bin,,
,is_work_tour,df.primary_purpose == 'work'
,work_time_factor,"reindex(persons.work_time_factor, df.person_id)"
,non_work_time_factor,"reindex(persons.non_work_time_factor, df.person_id)"
,c_ivt,trip_c_ivt_base * (is_work_tour * work_time_factor + (1 - is_work_tour) * non_work_time_factor)
,c_fwt,c_ivt * 1.5
,c_xwt,c_ivt * 1.5
,c_wacc,c_ivt * 1.5
,c_wegr,c_ivt * 1.5
,c_waux,c_ivt * 1.5
,c_xfers,c_ivt * 24
,c_walk_time,c_ivt * 1.8
,c_xfers_pnr,c_ivt * 15
,cost_per_mile,cost_per_mile_fuel + cost_per_mile_maint
,vot_da,c_ivt / trip_c_cost * 0.6
,vot_s2,vot_da * cost_share_s2
,vot_s3,vot_da * cost_share_s3
,vot_bin_da,"np.where(vot_da < vot_threshold_low, 1, np.where(vot_da < vot_threshold_med, 2, 3))"
,vot_bin_s2,"np.where(vot_s2 < vot_threshold_low, 1, np.where(vot_s2 < vot_threshold_med, 2, 3))"
,vot_bin_s3,"np.where(vot_s3 < vot_threshold_low, 1, np.where(vot_s3 < vot_threshold_med, 2, 3))"
,vot_1,"np.where((vot_bin_da ==1) | (vot_bin_s2 ==1) | (vot_bin_s3 == 1), True, False)"
,vot_2,"np.where((vot_bin_da ==2) | (vot_bin_s2 ==2) | (vot_bin_s3 == 1), True, False)"
,vot_3,"np.where((vot_bin_da ==3) | (vot_bin_s2 ==3) | (vot_bin_s3 == 1), True, False)"
# ea trips vehicle,,
,DRIVEALONE_EA_low,((trips.trip_mode == 'DRIVEALONE') & is_ea & vot_1) * tour_participants
,SHARED2_EA_low,((trips.trip_mode == 'SHARED2') & is_ea & vot_1) * tour_participants
,SHARED3_EA_low,((trips.trip_mode == 'SHARED3') & is_ea & vot_1) * tour_participants
,DRIVEALONE_EA_med,((trips.trip_mode == 'DRIVEALONE') & is_ea & vot_2) * tour_participants
,SHARED2_EA_med,((trips.trip_mode == 'SHARED2') & is_ea  & vot_2) * tour_participants
,SHARED3_EA_med,((trips.trip_mode == 'SHARED3') & is_ea & vot_2) * tour_participants
,DRIVEALONE_EA_high,((trips.trip_mode == 'DRIVEALONE') & is_ea & vot_3) * tour_participants
,SHARED2_EA_high,((trips.trip_mode == 'SHARED2') & is_ea & vot_3) * tour_participants
,SHARED3_EA_high,((trips.trip_mode == 'SHARED3') & is_ea & vot_3) * tour_participants
# ea trips non motorized,,
,WALK_EA,((trips.trip_mode == 'WALK') & is_ea) * tour_participants
#placeholder for bike,,
,BIKE_EA,((trips.trip_mode == 'BIKE') & is_ea) * tour_participants
# ea trips transit,,
,WALK_SET_set1_EA, (is_ea & is_walk_LOC_transit) * tour_participants
,WALK_SET_set2_EA, (is_ea & is_walk_PRM_transit) * tour_participants
,WALK_SET_set3_EA, (is_ea & is_walk_MIX_transit) * tour_participants
,PNROUT_SET_set1_EA,(is_ea & is_pnr_loc & outbound) * tour_participants 
,PNROUT_SET_set2_EA,(is_ea & is_pnr_prm & outbound) * tour_participants 
,PNROUT_SET_set3_EA,(is_ea & is_pnr_mix & outbound) * tour_participants 
,KNROUT_SET_set1_EA,(is_ea & is_knr_loc & outbound) * tour_participants 
,KNROUT_SET_set2_EA,(is_ea & is_knr_prm & outbound) * tour_participants 
,KNROUT_SET_set3_EA,(is_ea & is_knr_mix & outbound) * tour_participants 
,TNCOUT_SET_set1_EA,(is_ea & is_tnc_loc & outbound) * tour_participants 
,TNCOUT_SET_set2_EA,(is_ea & is_tnc_prm & outbound) * tour_participants 
,TNCOUT_SET_set3_EA,(is_ea & is_tnc_mix & outbound) * tour_participants
,PNRIN_SET_set1_EA,(is_ea & is_pnr_loc & inbound) * tour_participants 
,PNRIN_SET_set2_EA,(is_ea & is_pnr_prm & inbound) * tour_participants 
,PNRIN_SET_set3_EA,(is_ea & is_pnr_mix & inbound) * tour_participants 
,KNRIN_SET_set1_EA,(is_ea & is_knr_loc & inbound) * tour_participants 
,KNRIN_SET_set2_EA,(is_ea & is_knr_prm & inbound) * tour_participants 
,KNRIN_SET_set3_EA,(is_ea & is_knr_mix & inbound) * tour_participants 
,TNCIN_SET_set1_EA,(is_ea & is_tnc_loc & inbound) * tour_participants 
,TNCIN_SET_set2_EA,(is_ea & is_tnc_prm & inbound) * tour_participants 
,TNCIN_SET_set3_EA,(is_ea & is_tnc_mix & inbound) * tour_participants
,TAXI_EA,((trips.trip_mode == 'TAXI') & is_ea) * tour_participants
,TNC_SINGLE_EA,((trips.trip_mode == 'TNC_SINGLE') & is_ea) * tour_participants
,TNC_SHARED_EA,((trips.trip_mode == 'TNC_SHARED') & is_ea) * tour_participants
# am trips vehicle,,
,DRIVEALONE_AM_low,((trips.trip_mode == 'DRIVEALONE') & is_am & vot_1) * tour_participants
,SHARED2_AM_low,((trips.trip_mode == 'SHARED2') & is_am & vot_1) * tour_participants
,SHARED3_AM_low,((trips.trip_mode == 'SHARED3') & is_am & vot_1) * tour_participants
,DRIVEALONE_AM_med,((trips.trip_mode == 'DRIVEALONE') & is_am & vot_2) * tour_participants
,SHARED2_AM_med,((trips.trip_mode == 'SHARED2') & is_am  & vot_2) * tour_participants
,SHARED3_AM_med,((trips.trip_mode == 'SHARED3') & is_am & vot_2) * tour_participants
,DRIVEALONE_AM_high,((trips.trip_mode == 'DRIVEALONE') & is_am & vot_3) * tour_participants
,SHARED2_AM_high,((trips.trip_mode == 'SHARED2') & is_am & vot_3) * tour_participants
,SHARED3_AM_high,((trips.trip_mode == 'SHARED3') & is_am & vot_3) * tour_participants
# am trips non motorized,,
,WALK_AM,((trips.trip_mode == 'WALK') & is_am) * tour_participants
#placeholder for bike,,
,BIKE_AM,((trips.trip_mode == 'BIKE') & is_am) * tour_participants
# am trips transit,,
,WALK_SET_set1_AM,(is_am & is_walk_LOC_transit) * tour_participants
,WALK_SET_set2_AM,(is_am & is_walk_PRM_transit) * tour_participants
,WALK_SET_set3_AM,(is_am & is_walk_MIX_transit) * tour_participants
,PNROUT_SET_set1_AM,(is_am & is_pnr_loc & outbound) * tour_participants 
,PNROUT_SET_set2_AM,(is_am & is_pnr_prm & outbound) * tour_participants 
,PNROUT_SET_set3_AM,(is_am & is_pnr_mix & outbound) * tour_participants 
,KNROUT_SET_set1_AM,(is_am & is_knr_loc & outbound) * tour_participants 
,KNROUT_SET_set2_AM,(is_am & is_knr_prm & outbound) * tour_participants 
,KNROUT_SET_set3_AM,(is_am & is_knr_mix & outbound) * tour_participants 
,TNCOUT_SET_set1_AM,(is_am & is_tnc_loc & outbound) * tour_participants 
,TNCOUT_SET_set2_AM,(is_am & is_tnc_prm & outbound) * tour_participants 
,TNCOUT_SET_set3_AM,(is_am & is_tnc_mix & outbound) * tour_participants
,PNRIN_SET_set1_AM,(is_am & is_pnr_loc & inbound) * tour_participants 
,PNRIN_SET_set2_AM,(is_am & is_pnr_prm & inbound) * tour_participants 
,PNRIN_SET_set3_AM,(is_am & is_pnr_mix & inbound) * tour_participants 
,KNRIN_SET_set1_AM,(is_am & is_knr_loc & inbound) * tour_participants 
,KNRIN_SET_set2_AM,(is_am & is_knr_prm & inbound) * tour_participants 
,KNRIN_SET_set3_AM,(is_am & is_knr_mix & inbound) * tour_participants 
,TNCIN_SET_set1_AM,(is_am & is_tnc_loc & inbound) * tour_participants 
,TNCIN_SET_set2_AM,(is_am & is_tnc_prm & inbound) * tour_participants 
,TNCIN_SET_set3_AM,(is_am & is_tnc_mix & inbound) * tour_participants
,TAXI_AM,((trips.trip_mode == 'TAXI') & is_am) * tour_participants
,TNC_SINGLE_AM,((trips.trip_mode == 'TNC_SINGLE') & is_am) * tour_participants
,TNC_SHARED_AM,((trips.trip_mode == 'TNC_SHARED') & is_am) * tour_participants
# md trips vehicle,,
,DRIVEALONE_MD_low,((trips.trip_mode == 'DRIVEALONE') & is_md & vot_1) * tour_participants
,SHARED2_MD_low,((trips.trip_mode == 'SHARED2') & is_md & vot_1) * tour_participants
,SHARED3_MD_low,((trips.trip_mode == 'SHARED3') & is_md & vot_1) * tour_participants
,DRIVEALONE_MD_med,((trips.trip_mode == 'DRIVEALONE') & is_md & vot_2) * tour_participants
,SHARED2_MD_med,((trips.trip_mode == 'SHARED2') & is_md  & vot_2) * tour_participants
,SHARED3_MD_med,((trips.trip_mode == 'SHARED3') & is_md & vot_2) * tour_participants
,DRIVEALONE_MD_high,((trips.trip_mode == 'DRIVEALONE') & is_md & vot_3) * tour_participants
,SHARED2_MD_high,((trips.trip_mode == 'SHARED2') & is_md & vot_3) * tour_participants
,SHARED3_MD_high,((trips.trip_mode == 'SHARED3') & is_md & vot_3) * tour_participants
# md trips non motorized,,
,WALK_MD,((trips.trip_mode == 'WALK') & is_md) * tour_participants
#placeholder for bike,,
,BIKE_MD,((trips.trip_mode == 'BIKE') & is_md) * tour_participants
# md trips transit,,
,WALK_SET_set1_MD,(is_md & is_walk_LOC_transit) * tour_participants
,WALK_SET_set2_MD,(is_md & is_walk_PRM_transit) * tour_participants
,WALK_SET_set3_MD,(is_md & is_walk_MIX_transit) * tour_participants
,PNROUT_SET_set1_MD,(is_md & is_pnr_loc & outbound) * tour_participants 
,PNROUT_SET_set2_MD,(is_md & is_pnr_prm & outbound) * tour_participants 
,PNROUT_SET_set3_MD,(is_md & is_pnr_mix & outbound) * tour_participants 
,KNROUT_SET_set1_MD,(is_md & is_knr_loc & outbound) * tour_participants 
,KNROUT_SET_set2_MD,(is_md & is_knr_prm & outbound) * tour_participants 
,KNROUT_SET_set3_MD,(is_md & is_knr_mix & outbound) * tour_participants 
,TNCOUT_SET_set1_MD,(is_md & is_tnc_loc & outbound) * tour_participants 
,TNCOUT_SET_set2_MD,(is_md & is_tnc_prm & outbound) * tour_participants 
,TNCOUT_SET_set3_MD,(is_md & is_tnc_mix & outbound) * tour_participants
,PNRIN_SET_set1_MD,(is_md & is_pnr_loc & inbound) * tour_participants 
,PNRIN_SET_set2_MD,(is_md & is_pnr_prm & inbound) * tour_participants 
,PNRIN_SET_set3_MD,(is_md & is_pnr_mix & inbound) * tour_participants 
,KNRIN_SET_set1_MD,(is_md & is_knr_loc & inbound) * tour_participants 
,KNRIN_SET_set2_MD,(is_md & is_knr_prm & inbound) * tour_participants 
,KNRIN_SET_set3_MD,(is_md & is_knr_mix & inbound) * tour_participants 
,TNCIN_SET_set1_MD,(is_md & is_tnc_loc & inbound) * tour_participants 
,TNCIN_SET_set2_MD,(is_md & is_tnc_prm & inbound) * tour_participants 
,TNCIN_SET_set3_MD,(is_md & is_tnc_mix & inbound) * tour_participants
,TAXI_MD,((trips.trip_mode == 'TAXI') & is_md) * tour_participants
,TNC_SINGLE_MD,((trips.trip_mode == 'TNC_SINGLE') & is_md) * tour_participants
,TNC_SHARED_MD,((trips.trip_mode == 'TNC_SHARED') & is_md) * tour_participants
# pm trips vehicle,,
,DRIVEALONE_PM_low,((trips.trip_mode == 'DRIVEALONE') & is_pm & vot_1) * tour_participants
,SHARED2_PM_low,((trips.trip_mode == 'SHARED2') & is_pm & vot_1) * tour_participants
,SHARED3_PM_low,((trips.trip_mode == 'SHARED3') & is_pm & vot_1) * tour_participants
,DRIVEALONE_PM_med,((trips.trip_mode == 'DRIVEALONE') & is_pm & vot_2) * tour_participants
,SHARED2_PM_med,((trips.trip_mode == 'SHARED2') & is_pm  & vot_2) * tour_participants
,SHARED3_PM_med,((trips.trip_mode == 'SHARED3') & is_pm & vot_2) * tour_participants
,DRIVEALONE_PM_high,((trips.trip_mode == 'DRIVEALONE') & is_pm & vot_3) * tour_participants
,SHARED2_PM_high,((trips.trip_mode == 'SHARED2') & is_pm & vot_3) * tour_participants
,SHARED3_PM_high,((trips.trip_mode == 'SHARED3') & is_pm & vot_3) * tour_participants
# pm trips non motorized,,
,WALK_PM,((trips.trip_mode == 'WALK') & is_pm) * tour_participants
#placeholder for bike,,
,BIKE_PM,((trips.trip_mode == 'BIKE') & is_pm) * tour_participants
# pm trips transit,,
,WALK_SET_set1_PM,(is_pm & is_walk_LOC_transit) * tour_participants
,WALK_SET_set2_PM,(is_pm & is_walk_PRM_transit) * tour_participants
,WALK_SET_set3_PM,(is_pm & is_walk_MIX_transit) * tour_participants
,PNROUT_SET_set1_PM,(is_pm & is_pnr_loc & outbound) * tour_participants 
,PNROUT_SET_set2_PM,(is_pm & is_pnr_prm & outbound) * tour_participants 
,PNROUT_SET_set3_PM,(is_pm & is_pnr_mix & outbound) * tour_participants 
,KNROUT_SET_set1_PM,(is_pm & is_knr_loc & outbound) * tour_participants 
,KNROUT_SET_set2_PM,(is_pm & is_knr_prm & outbound) * tour_participants 
,KNROUT_SET_set3_PM,(is_pm & is_knr_mix & outbound) * tour_participants 
,TNCOUT_SET_set1_PM,(is_pm & is_tnc_loc & outbound) * tour_participants 
,TNCOUT_SET_set2_PM,(is_pm & is_tnc_prm & outbound) * tour_participants 
,TNCOUT_SET_set3_PM,(is_pm & is_tnc_mix & outbound) * tour_participants
,PNRIN_SET_set1_PM,(is_pm & is_pnr_loc & inbound) * tour_participants 
,PNRIN_SET_set2_PM,(is_pm & is_pnr_prm & inbound) * tour_participants 
,PNRIN_SET_set3_PM,(is_pm & is_pnr_mix & inbound) * tour_participants 
,KNRIN_SET_set1_PM,(is_pm & is_knr_loc & inbound) * tour_participants 
,KNRIN_SET_set2_PM,(is_pm & is_knr_prm & inbound) * tour_participants 
,KNRIN_SET_set3_PM,(is_pm & is_knr_mix & inbound) * tour_participants 
,TNCIN_SET_set1_PM,(is_pm & is_tnc_loc & inbound) * tour_participants 
,TNCIN_SET_set2_PM,(is_pm & is_tnc_prm & inbound) * tour_participants 
,TNCIN_SET_set3_PM,(is_pm & is_tnc_mix & inbound) * tour_participants
,TAXI_PM,((trips.trip_mode == 'TAXI') & is_pm) * tour_participants
,TNC_SINGLE_PM,((trips.trip_mode == 'TNC_SINGLE') & is_pm) * tour_participants
,TNC_SHARED_PM,((trips.trip_mode == 'TNC_SHARED') & is_pm) * tour_participants
# ev trips vehicle,,
,DRIVEALONE_EV_low,((trips.trip_mode == 'DRIVEALONE') & is_ev & vot_1) * tour_participants
,SHARED2_EV_low,((trips.trip_mode == 'SHARED2') & is_ev & vot_1) * tour_participants
,SHARED3_EV_low,((trips.trip_mode == 'SHARED3') & is_ev & vot_1) * tour_participants
,DRIVEALONE_EV_med,((trips.trip_mode == 'DRIVEALONE') & is_ev & vot_2) * tour_participants
,SHARED2_EV_med,((trips.trip_mode == 'SHARED2') & is_ev  & vot_2) * tour_participants
,SHARED3_EV_med,((trips.trip_mode == 'SHARED3') & is_ev & vot_2) * tour_participants
,DRIVEALONE_EV_high,((trips.trip_mode == 'DRIVEALONE') & is_ev & vot_3) * tour_participants
,SHARED2_EV_high,((trips.trip_mode == 'SHARED2') & is_ev & vot_3) * tour_participants
,SHARED3_EV_high,((trips.trip_mode == 'SHARED3') & is_ev & vot_3) * tour_participants
# ev trips non motorized,,
,WALK_EV,((trips.trip_mode == 'WALK') & is_ev) * tour_participants
#placeholder for bike,,
,BIKE_EV,((trips.trip_mode == 'BIKE') & is_ev) * tour_participants
# ev trips transit,,
,WALK_SET_set1_EV,(is_ev & is_walk_LOC_transit) * tour_participants
,WALK_SET_set2_EV,(is_ev & is_walk_PRM_transit) * tour_participants
,WALK_SET_set3_EV,(is_ev & is_walk_MIX_transit) * tour_participants
,PNROUT_SET_set1_EV,(is_ev & is_pnr_loc & outbound) * tour_participants 
,PNROUT_SET_set2_EV,(is_ev & is_pnr_prm & outbound) * tour_participants 
,PNROUT_SET_set3_EV,(is_ev & is_pnr_mix & outbound) * tour_participants 
,KNROUT_SET_set1_EV,(is_ev & is_knr_loc & outbound) * tour_participants 
,KNROUT_SET_set2_EV,(is_ev & is_knr_prm & outbound) * tour_participants 
,KNROUT_SET_set3_EV,(is_ev & is_knr_mix & outbound) * tour_participants 
,TNCOUT_SET_set1_EV,(is_ev & is_tnc_loc & outbound) * tour_participants 
,TNCOUT_SET_set2_EV,(is_ev & is_tnc_prm & outbound) * tour_participants 
,TNCOUT_SET_set3_EV,(is_ev & is_tnc_mix & outbound) * tour_participants
,PNRIN_SET_set1_EV,(is_ev & is_pnr_loc & inbound) * tour_participants 
,PNRIN_SET_set2_EV,(is_ev & is_pnr_prm & inbound) * tour_participants 
,PNRIN_SET_set3_EV,(is_ev & is_pnr_mix & inbound) * tour_participants 
,KNRIN_SET_set1_EV,(is_ev & is_knr_loc & inbound) * tour_participants 
,KNRIN_SET_set2_EV,(is_ev & is_knr_prm & inbound) * tour_participants 
,KNRIN_SET_set3_EV,(is_ev & is_knr_mix & inbound) * tour_participants 
,TNCIN_SET_set1_EV,(is_ev & is_tnc_loc & inbound) * tour_participants 
,TNCIN_SET_set2_EV,(is_ev & is_tnc_prm & inbound) * tour_participants 
,TNCIN_SET_set3_EV,(is_ev & is_tnc_mix & inbound) * tour_participants
,TAXI_EV,((trips.trip_mode == 'TAXI') & is_ev) * tour_participants
,TNC_SINGLE_EV,((trips.trip_mode == 'TNC_SINGLE') & is_ev) * tour_participants
,TNC_SHARED_EV,((trips.trip_mode == 'TNC_SHARED') & is_ev) * tour_participants
