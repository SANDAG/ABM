Description,Target,Expression
# add additional fields,,
,tour_participants,trips.tour_id.map(tours.number_of_participants)
#,distance,od_skims['DIST']
# code time periods,,
,is_ea,"trips.depart.between(time_periods['EA']['first_hour'], time_periods['EA']['last_hour'])"
,is_am,"trips.depart.between(time_periods['AM']['first_hour'], time_periods['AM']['last_hour'])"
,is_md,"trips.depart.between(time_periods['MD']['first_hour'], time_periods['MD']['last_hour'])"
,is_pm,"trips.depart.between(time_periods['PM']['first_hour'], time_periods['PM']['last_hour'])"
,is_ev,"trips.depart.between(time_periods['EV']['first_hour'], time_periods['EV']['last_hour'])"
,_vot_bin_da,"np.where(trips.vot_da < vot_threshold_low, 1, np.where(trips.vot_da < vot_threshold_med, 2, 3))"
,_vot_bin_s2,"np.where(trips.vot_s2 < vot_threshold_low, 1, np.where(trips.vot_s2 < vot_threshold_med, 2, 3))"
,_vot_bin_s3,"np.where(trips.vot_s3 < vot_threshold_low, 1, np.where(trips.vot_s3 < vot_threshold_med, 2, 3))"
,vot1,"np.where((_vot_bin_da == 1) |( _vot_bin_s2 == 1) |( _vot_bin_s3 ==1),1,0)"
,vot2,"np.where((_vot_bin_da == 2 )|( _vot_bin_s2 == 2) |( _vot_bin_s3 ==2),1,0)"
,vot3,"np.where((_vot_bin_da == 3) | (_vot_bin_s2 == 3) | (_vot_bin_s3 ==3),1,0)"
# ea trips,,
,DRIVEALONE_EA_LOW,((trips.trip_mode == 'DRIVEALONE') & is_ea  & vot1) * tour_participants
,SHARED2_EA_LOW,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_ea  & vot1) * tour_participants  / OCC_SHARED2"
,SHARED3_EA_LOW,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_ea  & vot1) * tour_participants / OCC_SHARED3"
,DRIVEALONE_EA_MED,((trips.trip_mode == 'DRIVEALONE') & is_ea  & vot2) * tour_participants
,SHARED2_EA_MED,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_ea  & vot2) * tour_participants  / OCC_SHARED2"
,SHARED3_EA_MED,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_ea  & vot2) * tour_participants / OCC_SHARED3"
,DRIVEALONE_EA_HIGH,((trips.trip_mode == 'DRIVEALONE') & is_ea  & vot3) * tour_participants
,SHARED2_EA_HIGH,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_ea  & vot3) * tour_participants  / OCC_SHARED2"
,SHARED3_EA_HIGH,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_ea  & vot3) * tour_participants / OCC_SHARED3"
,WALK_LOC_EA,((trips.trip_mode == 'WALK_LOC') & is_ea) * tour_participants
,WALK_PRM_EA,((trips.trip_mode == 'WALK_PRM') & is_ea) * tour_participants
,WALK_MIX_EA,((trips.trip_mode == 'WALK_MIX') & is_ea) * tour_participants
,PNR_LOC_EA,((trips.trip_mode == 'PNR_LOC') & is_ea) * tour_participants
,PNR_PRM_EA,((trips.trip_mode == 'PNR_PRM') & is_ea) * tour_participants
,PNR_MIX_EA,((trips.trip_mode == 'PNR_MIX') & is_ea) * tour_participants
,KNR_LOC_EA,"((trips.trip_mode.isin(['TNC_LOC','KNR_LOC'])) & is_ea) * tour_participants"
,KNR_PRM_EA,"((trips.trip_mode.isin(['TNC_PRM','KNR_PRM']))  & is_ea) * tour_participants"
,KNR_MIX_EA,"((trips.trip_mode.isin(['TNC_MIX','KNR_MIX'])) & is_ea) * tour_participants"
,BIKE_EA,((trips.trip_mode == 'BIKE') & is_ea) * tour_participants
,WALK_EA,((trips.trip_mode == 'WALK') & is_ea) * tour_participants
# am trips,,"
,DRIVEALONE_AM_LOW,((trips.trip_mode == 'DRIVEALONE') & is_am  & vot1) * tour_participants
,SHARED2_AM_LOW,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_am  & vot1) * tour_participants  / OCC_SHARED2"
,SHARED3_AM_LOW,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_am  & vot1) * tour_participants / OCC_SHARED3"
,DRIVEALONE_AM_MED,((trips.trip_mode == 'DRIVEALONE') & is_am  & vot2) * tour_participants
,SHARED2_AM_MED,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_am  & vot2) * tour_participants  / OCC_SHARED2"
,SHARED3_AM_MED,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_am  & vot2) * tour_participants / OCC_SHARED3"
,DRIVEALONE_AM_HIGH,((trips.trip_mode == 'DRIVEALONE') & is_am  & vot3) * tour_participants
,SHARED2_AM_HIGH,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_am  & vot3) * tour_participants  / OCC_SHARED2"
,SHARED3_AM_HIGH,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_am  & vot3) * tour_participants / OCC_SHARED3"
,WALK_LOC_AM,((trips.trip_mode == 'WALK_LOC') & is_am) * tour_participants
,WALK_PRM_AM,((trips.trip_mode == 'WALK_PRM') & is_am) * tour_participants
,WALK_MIX_AM,((trips.trip_mode == 'WALK_MIX') & is_am) * tour_participants
,PNR_LOC_AM,((trips.trip_mode == 'PNR_LOC') & is_am) * tour_participants
,PNR_PRM_AM,((trips.trip_mode == 'PNR_PRM') & is_am) * tour_participants
,PNR_MIX_AM,((trips.trip_mode == 'PNR_MIX') & is_am) * tour_participants
,KNR_LOC_AM,"((trips.trip_mode.isin(['TNC_LOC','KNR_LOC'])) & is_am) * tour_participants"
,KNR_PRM_AM,"((trips.trip_mode.isin(['TNC_PRM','KNR_PRM']))  & is_am) * tour_participants"
,KNR_MIX_AM,"((trips.trip_mode.isin(['TNC_MIX','KNR_MIX'])) & is_am) * tour_participants"
,BIKE_AM,((trips.trip_mode == 'BIKE') & is_am) * tour_participants
,WALK_AM,((trips.trip_mode == 'WALK') & is_am) * tour_participants
# md trips,,
,DRIVEALONE_MD_LOW,((trips.trip_mode == 'DRIVEALONE') & is_md  & vot1) * tour_participants
,SHARED2_MD_LOW,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_md  & vot1) * tour_participants  / OCC_SHARED2"
,SHARED3_MD_LOW,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_md  & vot1) * tour_participants / OCC_SHARED3"
,DRIVEALONE_MD_MED,((trips.trip_mode == 'DRIVEALONE') & is_md  & vot2) * tour_participants
,SHARED2_MD_MED,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_md  & vot2) * tour_participants  / OCC_SHARED2"
,SHARED3_MD_MED,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_md  & vot2) * tour_participants / OCC_SHARED3"
,DRIVEALONE_MD_HIGH,((trips.trip_mode == 'DRIVEALONE') & is_md  & vot3) * tour_participants
,SHARED2_MD_HIGH,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_md  & vot3) * tour_participants  / OCC_SHARED2"
,SHARED3_MD_HIGH,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_md  & vot3) * tour_participants / OCC_SHARED3"
,WALK_LOC_MD,((trips.trip_mode == 'WALK_LOC') & is_md) * tour_participants
,WALK_PRM_MD,((trips.trip_mode == 'WALK_PRM') & is_md) * tour_participants
,WALK_MIX_MD,((trips.trip_mode == 'WALK_MIX') & is_md) * tour_participants
,PNR_LOC_MD,((trips.trip_mode == 'PNR_LOC') & is_md) * tour_participants
,PNR_PRM_MD,((trips.trip_mode == 'PNR_PRM') & is_md) * tour_participants
,PNR_MIX_MD,((trips.trip_mode == 'PNR_MIX') & is_md) * tour_participants
,KNR_LOC_MD,"((trips.trip_mode.isin(['TNC_LOC','KNR_LOC'])) & is_md) * tour_participants"
,KNR_PRM_MD,"((trips.trip_mode.isin(['TNC_PRM','KNR_PRM']))  & is_md) * tour_participants"
,KNR_MIX_MD,"((trips.trip_mode.isin(['TNC_MIX','KNR_MIX'])) & is_md)  * tour_participants"
,BIKE_MD,((trips.trip_mode == 'BIKE') & is_md) * tour_participants
,WALK_MD,((trips.trip_mode == 'WALK') & is_md) * tour_participants
# pm trips,,"
,DRIVEALONE_PM_LOW,((trips.trip_mode == 'DRIVEALONE') & is_pm  & vot1) * tour_participants
,SHARED2_PM_LOW,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_pm  & vot1) * tour_participants  / OCC_SHARED2"
,SHARED3_PM_LOW,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_pm  & vot1) * tour_participants / OCC_SHARED3"
,DRIVEALONE_PM_MED,((trips.trip_mode == 'DRIVEALONE') & is_pm  & vot2) * tour_participants
,SHARED2_PM_MED,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_pm  & vot2) * tour_participants  / OCC_SHARED2"
,SHARED3_PM_MED,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_pm  & vot2) * tour_participants / OCC_SHARED3"
,DRIVEALONE_PM_HIGH,((trips.trip_mode == 'DRIVEALONE') & is_pm  & vot3) * tour_participants
,SHARED2_PM_HIGH,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_pm  & vot3) * tour_participants  / OCC_SHARED2"
,SHARED3_PM_HIGH,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_pm  & vot3) * tour_participants / OCC_SHARED3"
,WALK_LOC_PM,((trips.trip_mode == 'WALK_LOC') & is_pm) * tour_participants
,WALK_PRM_PM,((trips.trip_mode == 'WALK_PRM') & is_pm) * tour_participants
,WALK_MIX_PM,((trips.trip_mode == 'WALK_MIX') & is_pm) * tour_participants
,PNR_LOC_PM,((trips.trip_mode == 'PNR_LOC') & is_pm) * tour_participants
,PNR_PRM_PM,((trips.trip_mode == 'PNR_PRM') & is_pm) * tour_participants
,PNR_MIX_PM,((trips.trip_mode == 'PNR_MIX') & is_pm) * tour_participants
,KNR_LOC_PM,"((trips.trip_mode.isin(['TNC_LOC','KNR_LOC'])) & is_pm) * tour_participants"
,KNR_PRM_PM,"((trips.trip_mode.isin(['TNC_PRM','KNR_PRM']))  & is_pm) * tour_participants"
,KNR_MIX_PM,"((trips.trip_mode.isin(['TNC_MIX','KNR_MIX'])) & is_pm) * tour_participants"
,BIKE_PM,((trips.trip_mode == 'BIKE') & is_pm) * tour_participants
,WALK_PM,((trips.trip_mode == 'WALK') & is_pm) * tour_participants
# ev trips,,"
,DRIVEALONE_EV_LOW,((trips.trip_mode == 'DRIVEALONE') & is_ev  & vot1) * tour_participants
,SHARED2_EV_LOW,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_ev  & vot1) * tour_participants  / OCC_SHARED2"
,SHARED3_EV_LOW,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_ev  & vot1) * tour_participants / OCC_SHARED3"
,DRIVEALONE_EV_MED,((trips.trip_mode == 'DRIVEALONE') & is_ev  & vot2) * tour_participants
,SHARED2_EV_MED,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_ev  & vot2) * tour_participants  / OCC_SHARED2"
,SHARED3_EV_MED,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_ev  & vot2) * tour_participants / OCC_SHARED3"
,DRIVEALONE_EV_HIGH,((trips.trip_mode == 'DRIVEALONE') & is_ev  & vot3) * tour_participants
,SHARED2_EV_HIGH,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_ev  & vot3) * tour_participants  / OCC_SHARED2"
,SHARED3_EV_HIGH,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_ev  & vot3) * tour_participants / OCC_SHARED3"
,WALK_LOC_EV,((trips.trip_mode == 'WALK_LOC') & is_ev) * tour_participants
,WALK_PRM_EV,((trips.trip_mode == 'WALK_PRM') & is_ev) * tour_participants
,WALK_MIX_EV,((trips.trip_mode == 'WALK_MIX') & is_ev) * tour_participants
,PNR_LOC_EV,((trips.trip_mode == 'PNR_LOC') & is_ev) * tour_participants
,PNR_PRM_EV,((trips.trip_mode == 'PNR_PRM') & is_ev) * tour_participants
,PNR_MIX_EV,((trips.trip_mode == 'PNR_MIX') & is_ev) * tour_participants
,KNR_LOC_EV,"((trips.trip_mode.isin(['TNC_LOC','KNR_LOC'])) & is_ev) * tour_participants"
,KNR_PRM_EV,"((trips.trip_mode.isin(['TNC_PRM','KNR_PRM']))  & is_ev) * tour_participants"
,KNR_MIX_EV,"((trips.trip_mode.isin(['TNC_MIX','KNR_MIX'])) & is_ev) * tour_participants"
,BIKE_EV,((trips.trip_mode == 'BIKE') & is_ev) * tour_participants
,WALK_EV,((trips.trip_mode == 'WALK') & is_ev) * tour_participants
