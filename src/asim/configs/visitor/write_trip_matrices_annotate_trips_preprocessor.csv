Description,Target,Expression,,
# add additional fields,,,,
,tour_participants,trips.tour_id.map(tours.number_of_participants),,
#,distance,od_skims['DIST'],,
# code time periods,,,,
,is_ea,"trips.depart.between(time_periods['EA']['first_hour'], time_periods['EA']['last_hour'])",,
,is_am,"trips.depart.between(time_periods['AM']['first_hour'], time_periods['AM']['last_hour'])",,
,is_md,"trips.depart.between(time_periods['MD']['first_hour'], time_periods['MD']['last_hour'])",,
,is_pm,"trips.depart.between(time_periods['PM']['first_hour'], time_periods['PM']['last_hour'])",,
,is_ev,"trips.depart.between(time_periods['EV']['first_hour'], time_periods['EV']['last_hour'])",,
,is_walk_LOC_transit,trips.trip_mode == 'WALK_LOC',,
,is_walk_PRM_transit,trips.trip_mode.isin == 'WALK_PRM',,
,is_walk_MIX_transit,trips.trip_mode.isin == 'WALK_MIX',,
,is_knr_loc,trips.trip_mode.isin(['KNR_LOC']),,
,is_knr_prm,trips.trip_mode.isin(['KNR_PRM']),,
,is_knr_mix,trips.trip_mode.isin(['KNR_MIX']),,
,is_tnc_loc,trips.trip_mode.isin(['TNC_LOC']),,
,is_tnc_prm,trips.trip_mode.isin(['TNC_PRM']),,
,is_tnc_mix,trips.trip_mode.isin(['TNC_MIX']),,
,is_pnr_loc,trips.trip_mode.isin(['PNR_LOC']),,
,is_pnr_prm,trips.trip_mode.isin(['PNR_PRM']),,
,is_pnr_mix,trips.trip_mode.isin(['PNR_MIX']),,
,_vot_bin_da,"np.where(trips.vot_da < vot_threshold_low, 1, np.where(trips.vot_da < vot_threshold_med, 2, 3))",,
,_vot_bin_s2,"np.where(trips.vot_s2 < vot_threshold_low, 1, np.where(trips.vot_s2 < vot_threshold_med, 2, 3))",,
,_vot_bin_s3,"np.where(trips.vot_s3 < vot_threshold_low, 1, np.where(trips.vot_s3 < vot_threshold_med, 2, 3))",,
,vot1,"np.where((_vot_bin_da == 1) |( _vot_bin_s2 == 1) |( _vot_bin_s3 ==1),1,0)",,
,vot2,"np.where((_vot_bin_da == 2 )|( _vot_bin_s2 == 2) |( _vot_bin_s3 ==2),1,0)",,
,vot3,"np.where((_vot_bin_da == 3) | (_vot_bin_s2 == 3) | (_vot_bin_s3 ==3),1,0)",,
,outbound,trips.outbound,,
,inbound,~trips.outbound,,
# ea trips,,,,
,DRIVEALONE_EA_LOW,((trips.trip_mode == 'DRIVEALONE') & is_ea  & vot1) * tour_participants,,
,SHARED2_EA_LOW,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_ea  & vot1) * tour_participants  / OCC_SHARED2",,
,SHARED3_EA_LOW,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_ea  & vot1) * tour_participants / OCC_SHARED3",,
,DRIVEALONE_EA_MED,((trips.trip_mode == 'DRIVEALONE') & is_ea  & vot2) * tour_participants,,
,SHARED2_EA_MED,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_ea  & vot2) * tour_participants  / OCC_SHARED2",,
,SHARED3_EA_MED,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_ea  & vot2) * tour_participants / OCC_SHARED3",,
,DRIVEALONE_EA_HIGH,((trips.trip_mode == 'DRIVEALONE') & is_ea  & vot3) * tour_participants,,
,SHARED2_EA_HIGH,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_ea  & vot3) * tour_participants  / OCC_SHARED2",,
,SHARED3_EA_HIGH,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_ea  & vot3) * tour_participants / OCC_SHARED3",,
,WALK_SET_set1_EA,(is_ea & is_walk_LOC_transit) * tour_participants,,
,WALK_SET_set2_EA,(is_ea & is_walk_PRM_transit) * tour_participants,,
,WALK_SET_set3_EA,(is_ea & is_walk_MIX_transit) * tour_participants,,
,PNROUT_SET_set1_EA,(is_ea & is_pnr_loc & outbound) * tour_participants,,
,PNROUT_SET_set2_EA,(is_ea & is_pnr_prm & outbound) * tour_participants,,
,PNROUT_SET_set3_EA,(is_ea & is_pnr_mix & outbound) * tour_participants,,
,KNROUT_SET_set1_EA,(is_ea & is_knr_loc & outbound) * tour_participants,,
,KNROUT_SET_set2_EA,(is_ea & is_knr_prm & outbound) * tour_participants,,
,KNROUT_SET_set3_EA,(is_ea & is_knr_mix & outbound) * tour_participants,,
,TNCOUT_SET_set1_EA,(is_ea & is_tnc_loc & outbound) * tour_participants,,
,TNCOUT_SET_set2_EA,(is_ea & is_tnc_prm & outbound) * tour_participants,,
,TNCOUT_SET_set3_EA,(is_ea & is_tnc_mix & outbound) * tour_participants,,
,PNRIN_SET_set1_EA,(is_ea & is_pnr_loc & inbound) * tour_participants,,
,PNRIN_SET_set2_EA,(is_ea & is_pnr_prm & inbound) * tour_participants,,
,PNRIN_SET_set3_EA,(is_ea & is_pnr_mix & inbound) * tour_participants,,
,KNRIN_SET_set1_EA,(is_ea & is_knr_loc & inbound) * tour_participants,,
,KNRIN_SET_set2_EA,(is_ea & is_knr_prm & inbound) * tour_participants,,
,KNRIN_SET_set3_EA,(is_ea & is_knr_mix & inbound) * tour_participants,,
,TNCIN_SET_set1_EA,(is_ea & is_tnc_loc & inbound) * tour_participants,,
,TNCIN_SET_set2_EA,(is_ea & is_tnc_prm & inbound) * tour_participants,,
,TNCIN_SET_set3_EA,(is_ea & is_tnc_mix & inbound) * tour_participants,,
,BIKE_EA,((trips.trip_mode == 'BIKE') & is_ea) * tour_participants,,
,WALK_EA,((trips.trip_mode == 'WALK') & is_ea) * tour_participants,,
# am trips,,,,
,DRIVEALONE_AM_LOW,((trips.trip_mode == 'DRIVEALONE') & is_am  & vot1) * tour_participants
,SHARED2_AM_LOW,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_am  & vot1) * tour_participants  / OCC_SHARED2",,
,SHARED3_AM_LOW,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_am  & vot1) * tour_participants / OCC_SHARED3",,
,DRIVEALONE_AM_MED,((trips.trip_mode == 'DRIVEALONE') & is_am  & vot2) * tour_participants,,
,SHARED2_AM_MED,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_am  & vot2) * tour_participants  / OCC_SHARED2",,
,SHARED3_AM_MED,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_am  & vot2) * tour_participants / OCC_SHARED3",,
,DRIVEALONE_AM_HIGH,((trips.trip_mode == 'DRIVEALONE') & is_am  & vot3) * tour_participants,,
,SHARED2_AM_HIGH,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_am  & vot3) * tour_participants  / OCC_SHARED2",,
,SHARED3_AM_HIGH,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_am  & vot3) * tour_participants / OCC_SHARED3",,
,WALK_SET_set1_AM,(is_am & is_walk_LOC_transit) * tour_participants,,
,WALK_SET_set2_AM,(is_am & is_walk_PRM_transit) * tour_participants,,
,WALK_SET_set3_AM,(is_am & is_walk_MIX_transit) * tour_participants,,
,PNROUT_SET_set1_AM,(is_am & is_pnr_loc & outbound) * tour_participants ,,
,PNROUT_SET_set2_AM,(is_am & is_pnr_prm & outbound) * tour_participants ,,
,PNROUT_SET_set3_AM,(is_am & is_pnr_mix & outbound) * tour_participants ,,
,KNROUT_SET_set1_AM,(is_am & is_knr_loc & outbound) * tour_participants ,,
,KNROUT_SET_set2_AM,(is_am & is_knr_prm & outbound) * tour_participants ,,
,KNROUT_SET_set3_AM,(is_am & is_knr_mix & outbound) * tour_participants ,,
,TNCOUT_SET_set1_AM,(is_am & is_tnc_loc & outbound) * tour_participants ,,
,TNCOUT_SET_set2_AM,(is_am & is_tnc_prm & outbound) * tour_participants ,,
,TNCOUT_SET_set3_AM,(is_am & is_tnc_mix & outbound) * tour_participants,,
,PNRIN_SET_set1_AM,(is_am & is_pnr_loc & inbound) * tour_participants ,,
,PNRIN_SET_set2_AM,(is_am & is_pnr_prm & inbound) * tour_participants ,,
,PNRIN_SET_set3_AM,(is_am & is_pnr_mix & inbound) * tour_participants ,,
,KNRIN_SET_set1_AM,(is_am & is_knr_loc & inbound) * tour_participants ,,
,KNRIN_SET_set2_AM,(is_am & is_knr_prm & inbound) * tour_participants ,,
,KNRIN_SET_set3_AM,(is_am & is_knr_mix & inbound) * tour_participants ,,
,TNCIN_SET_set1_AM,(is_am & is_tnc_loc & inbound) * tour_participants ,,
,TNCIN_SET_set2_AM,(is_am & is_tnc_prm & inbound) * tour_participants ,,
,TNCIN_SET_set3_AM,(is_am & is_tnc_mix & inbound) * tour_participants,,
,BIKE_AM,((trips.trip_mode == 'BIKE') & is_am) * tour_participants,,
,WALK_AM,((trips.trip_mode == 'WALK') & is_am) * tour_participants,,
# md trips,,,,
,DRIVEALONE_MD_LOW,((trips.trip_mode == 'DRIVEALONE') & is_md  & vot1) * tour_participants,,
,SHARED2_MD_LOW,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_md  & vot1) * tour_participants  / OCC_SHARED2",,
,SHARED3_MD_LOW,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_md  & vot1) * tour_participants / OCC_SHARED3",,
,DRIVEALONE_MD_MED,((trips.trip_mode == 'DRIVEALONE') & is_md  & vot2) * tour_participants,,
,SHARED2_MD_MED,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_md  & vot2) * tour_participants  / OCC_SHARED2",,
,SHARED3_MD_MED,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_md  & vot2) * tour_participants / OCC_SHARED3",,
,DRIVEALONE_MD_HIGH,((trips.trip_mode == 'DRIVEALONE') & is_md  & vot3) * tour_participants,,
,SHARED2_MD_HIGH,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_md  & vot3) * tour_participants  / OCC_SHARED2",,
,SHARED3_MD_HIGH,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_md  & vot3) * tour_participants / OCC_SHARED3",,
,WALK_SET_set1_MD,(is_md & is_walk_LOC_transit) * tour_participants,,
,WALK_SET_set2_MD,(is_md & is_walk_PRM_transit) * tour_participants,,
,WALK_SET_set3_MD,(is_md & is_walk_MIX_transit) * tour_participants,,
,PNROUT_SET_set1_MD,(is_md & is_pnr_loc & outbound) * tour_participants ,,
,PNROUT_SET_set2_MD,(is_md & is_pnr_prm & outbound) * tour_participants ,,
,PNROUT_SET_set3_MD,(is_md & is_pnr_mix & outbound) * tour_participants ,,
,KNROUT_SET_set1_MD,(is_md & is_knr_loc & outbound) * tour_participants ,,
,KNROUT_SET_set2_MD,(is_md & is_knr_prm & outbound) * tour_participants ,,
,KNROUT_SET_set3_MD,(is_md & is_knr_mix & outbound) * tour_participants ,,
,TNCOUT_SET_set1_MD,(is_md & is_tnc_loc & outbound) * tour_participants ,,
,TNCOUT_SET_set2_MD,(is_md & is_tnc_prm & outbound) * tour_participants ,,
,TNCOUT_SET_set3_MD,(is_md & is_tnc_mix & outbound) * tour_participants,,
,PNRIN_SET_set1_MD,(is_md & is_pnr_loc & inbound) * tour_participants ,,
,PNRIN_SET_set2_MD,(is_md & is_pnr_prm & inbound) * tour_participants ,,
,PNRIN_SET_set3_MD,(is_md & is_pnr_mix & inbound) * tour_participants ,,
,KNRIN_SET_set1_MD,(is_md & is_knr_loc & inbound) * tour_participants ,,
,KNRIN_SET_set2_MD,(is_md & is_knr_prm & inbound) * tour_participants ,,
,KNRIN_SET_set3_MD,(is_md & is_knr_mix & inbound) * tour_participants ,,
,TNCIN_SET_set1_MD,(is_md & is_tnc_loc & inbound) * tour_participants ,,
,TNCIN_SET_set2_MD,(is_md & is_tnc_prm & inbound) * tour_participants ,,
,TNCIN_SET_set3_MD,(is_md & is_tnc_mix & inbound) * tour_participants,,
,BIKE_MD,((trips.trip_mode == 'BIKE') & is_md) * tour_participants,,
,WALK_MD,((trips.trip_mode == 'WALK') & is_md) * tour_participants,,
# pm trips,,,,
,DRIVEALONE_PM_LOW,((trips.trip_mode == 'DRIVEALONE') & is_pm  & vot1) * tour_participants
,SHARED2_PM_LOW,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_pm  & vot1) * tour_participants  / OCC_SHARED2",,
,SHARED3_PM_LOW,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_pm  & vot1) * tour_participants / OCC_SHARED3",,
,DRIVEALONE_PM_MED,((trips.trip_mode == 'DRIVEALONE') & is_pm  & vot2) * tour_participants,,
,SHARED2_PM_MED,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_pm  & vot2) * tour_participants  / OCC_SHARED2",,
,SHARED3_PM_MED,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_pm  & vot2) * tour_participants / OCC_SHARED3",,
,DRIVEALONE_PM_HIGH,((trips.trip_mode == 'DRIVEALONE') & is_pm  & vot3) * tour_participants,,
,SHARED2_PM_HIGH,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_pm  & vot3) * tour_participants  / OCC_SHARED2",,
,SHARED3_PM_HIGH,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_pm  & vot3) * tour_participants / OCC_SHARED3",,
,WALK_SET_set1_PM,(is_pm & is_walk_LOC_transit) * tour_participants,,
,WALK_SET_set2_PM,(is_pm & is_walk_PRM_transit) * tour_participants,,
,WALK_SET_set3_PM,(is_pm & is_walk_MIX_transit) * tour_participants,,
,PNROUT_SET_set1_PM,(is_pm & is_pnr_loc & outbound) * tour_participants ,,
,PNROUT_SET_set2_PM,(is_pm & is_pnr_prm & outbound) * tour_participants ,,
,PNROUT_SET_set3_PM,(is_pm & is_pnr_mix & outbound) * tour_participants ,,
,KNROUT_SET_set1_PM,(is_pm & is_knr_loc & outbound) * tour_participants ,,
,KNROUT_SET_set2_PM,(is_pm & is_knr_prm & outbound) * tour_participants ,,
,KNROUT_SET_set3_PM,(is_pm & is_knr_mix & outbound) * tour_participants ,,
,TNCOUT_SET_set1_PM,(is_pm & is_tnc_loc & outbound) * tour_participants ,,
,TNCOUT_SET_set2_PM,(is_pm & is_tnc_prm & outbound) * tour_participants ,,
,TNCOUT_SET_set3_PM,(is_pm & is_tnc_mix & outbound) * tour_participants,,
,PNRIN_SET_set1_PM,(is_pm & is_pnr_loc & inbound) * tour_participants ,,
,PNRIN_SET_set2_PM,(is_pm & is_pnr_prm & inbound) * tour_participants ,,
,PNRIN_SET_set3_PM,(is_pm & is_pnr_mix & inbound) * tour_participants ,,
,KNRIN_SET_set1_PM,(is_pm & is_knr_loc & inbound) * tour_participants ,,
,KNRIN_SET_set2_PM,(is_pm & is_knr_prm & inbound) * tour_participants ,,
,KNRIN_SET_set3_PM,(is_pm & is_knr_mix & inbound) * tour_participants ,,
,TNCIN_SET_set1_PM,(is_pm & is_tnc_loc & inbound) * tour_participants ,,
,TNCIN_SET_set2_PM,(is_pm & is_tnc_prm & inbound) * tour_participants ,,
,TNCIN_SET_set3_PM,(is_pm & is_tnc_mix & inbound) * tour_participants,,
,BIKE_PM,((trips.trip_mode == 'BIKE') & is_pm) * tour_participants,,
,WALK_PM,((trips.trip_mode == 'WALK') & is_pm) * tour_participants,,
# ev trips,,,,
,DRIVEALONE_EV_LOW,((trips.trip_mode == 'DRIVEALONE') & is_ev  & vot1) * tour_participants
,SHARED2_EV_LOW,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_ev  & vot1) * tour_participants  / OCC_SHARED2",,
,SHARED3_EV_LOW,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_ev  & vot1) * tour_participants / OCC_SHARED3",,
,DRIVEALONE_EV_MED,((trips.trip_mode == 'DRIVEALONE') & is_ev  & vot2) * tour_participants,,
,SHARED2_EV_MED,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_ev  & vot2) * tour_participants  / OCC_SHARED2",,
,SHARED3_EV_MED,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_ev  & vot2) * tour_participants / OCC_SHARED3",,
,DRIVEALONE_EV_HIGH,((trips.trip_mode == 'DRIVEALONE') & is_ev  & vot3) * tour_participants,,
,SHARED2_EV_HIGH,"(trips.trip_mode.isin(['SHARED2','TAXI','TNC_SINGLE']) & is_ev  & vot3) * tour_participants  / OCC_SHARED2",,
,SHARED3_EV_HIGH,"(trips.trip_mode.isin(['SHARED3','TNC_SHARED']) & is_ev  & vot3) * tour_participants / OCC_SHARED3",,
,WALK_SET_set1_EV,(is_ev & is_walk_LOC_transit) * tour_participants,,
,WALK_SET_set2_EV,(is_ev & is_walk_PRM_transit) * tour_participants,,
,WALK_SET_set3_EV,(is_ev & is_walk_MIX_transit) * tour_participants,,
,PNROUT_SET_set1_EV,(is_ev & is_pnr_loc & outbound) * tour_participants ,,
,PNROUT_SET_set2_EV,(is_ev & is_pnr_prm & outbound) * tour_participants ,,
,PNROUT_SET_set3_EV,(is_ev & is_pnr_mix & outbound) * tour_participants ,,
,KNROUT_SET_set1_EV,(is_ev & is_knr_loc & outbound) * tour_participants ,,
,KNROUT_SET_set2_EV,(is_ev & is_knr_prm & outbound) * tour_participants ,,
,KNROUT_SET_set3_EV,(is_ev & is_knr_mix & outbound) * tour_participants ,,
,TNCOUT_SET_set1_EV,(is_ev & is_tnc_loc & outbound) * tour_participants ,,
,TNCOUT_SET_set2_EV,(is_ev & is_tnc_prm & outbound) * tour_participants ,,
,TNCOUT_SET_set3_EV,(is_ev & is_tnc_mix & outbound) * tour_participants,,
,PNRIN_SET_set1_EV,(is_ev & is_pnr_loc & inbound) * tour_participants ,,
,PNRIN_SET_set2_EV,(is_ev & is_pnr_prm & inbound) * tour_participants ,,
,PNRIN_SET_set3_EV,(is_ev & is_pnr_mix & inbound) * tour_participants ,,
,KNRIN_SET_set1_EV,(is_ev & is_knr_loc & inbound) * tour_participants ,,
,KNRIN_SET_set2_EV,(is_ev & is_knr_prm & inbound) * tour_participants ,,
,KNRIN_SET_set3_EV,(is_ev & is_knr_mix & inbound) * tour_participants ,,
,TNCIN_SET_set1_EV,(is_ev & is_tnc_loc & inbound) * tour_participants ,,
,TNCIN_SET_set2_EV,(is_ev & is_tnc_prm & inbound) * tour_participants ,,
,TNCIN_SET_set3_EV,(is_ev & is_tnc_mix & inbound) * tour_participants,,
,BIKE_EV,((trips.trip_mode == 'BIKE') & is_ev) * tour_participants,,
,WALK_EV,((trips.trip_mode == 'WALK') & is_ev) * tour_participants,,
